<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eureka GEO Dashboard - Generative Engine Optimization</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/echarts/5.4.3/echarts.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #0a0f1c;
            color: #e0e0e0;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Header Styles */
        .header {
            background: linear-gradient(135deg, #1a237e 0%, #3949ab 100%);
            padding: 20px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
            color: #fff;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            width: 40px;
            height: 40px;
            background: #00e5ff;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #1a237e;
        }

        .nav-menu {
            display: flex;
            gap: 30px;
            list-style: none;
        }

        .nav-menu a {
            color: #fff;
            text-decoration: none;
            font-weight: 500;
            transition: opacity 0.3s;
        }

        .nav-menu a:hover {
            opacity: 0.8;
        }

        /* Main Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* KPI Cards */
        .kpi-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .kpi-card {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: transform 0.3s, box-shadow 0.3s;
            position: relative;
            overflow: hidden;
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            transform: rotate(45deg);
        }

        .kpi-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .kpi-title {
            font-size: 14px;
            color: #b3e5fc;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .kpi-value {
            font-size: 36px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 5px;
        }

        .kpi-change {
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .kpi-change.positive {
            color: #4caf50;
        }

        .kpi-change.negative {
            color: #f44336;
        }

        /* Chart Section */
        .chart-section {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: #1a2332;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 600;
            color: #fff;
        }

        .chart-controls {
            display: flex;
            gap: 10px;
        }

        .chart-control-btn {
            background: #2a3f5f;
            border: none;
            color: #fff;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.3s;
        }

        .chart-control-btn:hover {
            background: #3a4f6f;
        }

        .chart-control-btn.active {
            background: #00e5ff;
            color: #1a237e;
        }

        .chart-container {
            height: 300px;
        }

        /* Query Analysis Section */
        .query-section {
            background: #1a2332;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .query-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .query-input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .query-input {
            flex: 1;
            background: #0a0f1c;
            border: 1px solid #2a3f5f;
            color: #fff;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .query-input:focus {
            outline: none;
            border-color: #00e5ff;
        }

        .query-btn {
            background: linear-gradient(135deg, #00e5ff 0%, #00acc1 100%);
            border: none;
            color: #1a237e;
            padding: 12px 30px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .query-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 229, 255, 0.3);
        }

        /* Platform Performance Grid */
        .platform-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .platform-card {
            background: #1a2332;
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #2a3f5f;
            transition: border-color 0.3s;
        }

        .platform-card:hover {
            border-color: #00e5ff;
        }

        .platform-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .platform-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
        }

        .platform-icon.google {
            background: #4285f4;
            color: white;
        }

        .platform-icon.chatgpt {
            background: #00a67e;
            color: white;
        }

        .platform-icon.perplexity {
            background: #20b2aa;
            color: white;
        }

        .platform-metrics {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .metric-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .metric-label {
            color: #8892b0;
            font-size: 14px;
        }

        .metric-value {
            font-weight: 600;
            font-size: 16px;
        }

        /* Content Analysis Table */
        .content-table {
            width: 100%;
            background: #1a2332;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .content-table-header {
            background: #2a3f5f;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-filters {
            display: flex;
            gap: 10px;
        }

        .filter-select {
            background: #1a2332;
            border: 1px solid #3a4f6f;
            color: #fff;
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 14px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #2a3f5f;
            padding: 15px;
            text-align: left;
            font-weight: 600;
            color: #b3e5fc;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        td {
            padding: 15px;
            border-bottom: 1px solid #2a3f5f;
            font-size: 14px;
        }

        tr:hover {
            background: #2a3442;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-badge.active {
            background: #4caf50;
            color: white;
        }

        .status-badge.pending {
            background: #ff9800;
            color: white;
        }

        /* RAG Testing Panel */
        .rag-test-panel {
            background: #1a2332;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .test-output {
            background: #0a0f1c;
            border: 1px solid #2a3f5f;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            min-height: 150px;
            white-space: pre-wrap;
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #00e5ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .chart-section {
                grid-template-columns: 1fr;
            }

            .platform-grid {
                grid-template-columns: 1fr;
            }

            .nav-menu {
                display: none;
            }

            .query-input-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">
                <div class="logo-icon">E</div>
                Eureka GEO Dashboard
            </a>
            <nav>
                <ul class="nav-menu">
                    <li><a href="#overview">Overview</a></li>
                    <li><a href="#analysis">Analysis</a></li>
                    <li><a href="#content">Content</a></li>
                    <li><a href="#monitoring">Monitoring</a></li>
                    <li><a href="#settings">Settings</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container">
        <!-- KPI Section -->
        <section class="kpi-section">
            <div class="kpi-card">
                <div class="kpi-title">Brand Mention Rate (BMR)</div>
                <div class="kpi-value" id="bmr-value">72.5%</div>
                <div class="kpi-change positive">
                    <span>↑</span> +5.2% from last week
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-title">Answer Accuracy</div>
                <div class="kpi-value" id="accuracy-value">94.8%</div>
                <div class="kpi-change positive">
                    <span>↑</span> +2.1% from last week
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-title">Hallucination Rate</div>
                <div class="kpi-value" id="hallucination-value">1.8%</div>
                <div class="kpi-change positive">
                    <span>↓</span> -0.3% from last week
                </div>
            </div>
            <div class="kpi-card">
                <div class="kpi-title">Avg Response Time</div>
                <div class="kpi-value" id="latency-value">285ms</div>
                <div class="kpi-change positive">
                    <span>↓</span> -15ms from last week
                </div>
            </div>
        </section>

        <!-- Query Analysis Section -->
        <section class="query-section">
            <div class="query-header">
                <h2 class="chart-title">RAG Query Testing</h2>
                <span id="test-status" style="color: #4caf50;">Ready</span>
            </div>
            <div class="query-input-group">
                <input type="text" class="query-input" id="test-query" placeholder="Enter test query (e.g., 'What makes Eureka FC9 Pro special?')">
                <select class="query-input" id="platform-select" style="flex: 0 0 200px;">
                    <option value="all">All Platforms</option>
                    <option value="google">Google AI Overviews</option>
                    <option value="chatgpt">ChatGPT Browse</option>
                    <option value="perplexity">Perplexity</option>
                </select>
                <button class="query-btn" onclick="testQuery()">Test Query</button>
            </div>
            <div class="test-output" id="test-output">
                Query results will appear here...
            </div>
        </section>

        <!-- Charts Section -->
        <section class="chart-section">
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Brand Mention Rate Trend</h3>
                    <div class="chart-controls">
                        <button class="chart-control-btn active" onclick="updateBMRChart('7d')">7D</button>
                        <button class="chart-control-btn" onclick="updateBMRChart('30d')">30D</button>
                        <button class="chart-control-btn" onclick="updateBMRChart('90d')">90D</button>
                    </div>
                </div>
                <div id="bmr-chart" class="chart-container"></div>
            </div>
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Query Volume by Platform</h3>
                    <div class="chart-controls">
                        <button class="chart-control-btn active">Live</button>
                    </div>
                </div>
                <div id="platform-chart" class="chart-container"></div>
            </div>
        </section>

        <!-- Platform Performance Grid -->
        <section class="platform-grid">
            <div class="platform-card">
                <div class="platform-header">
                    <div class="platform-icon google">G</div>
                    <div>
                        <h3>Google AI Overviews</h3>
                        <p style="font-size: 12px; color: #8892b0;">Last updated: 2 min ago</p>
                    </div>
                </div>
                <div class="platform-metrics">
                    <div class="metric-row">
                        <span class="metric-label">Visibility Score</span>
                        <span class="metric-value" style="color: #4caf50;">78%</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Tech Feature Citations</span>
                        <span class="metric-value">142</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Avg. Position</span>
                        <span class="metric-value">#2</span>
                    </div>
                </div>
            </div>
            <div class="platform-card">
                <div class="platform-header">
                    <div class="platform-icon chatgpt">C</div>
                    <div>
                        <h3>ChatGPT Browse</h3>
                        <p style="font-size: 12px; color: #8892b0;">Last updated: 5 min ago</p>
                    </div>
                </div>
                <div class="platform-metrics">
                    <div class="metric-row">
                        <span class="metric-label">Visibility Score</span>
                        <span class="metric-value" style="color: #4caf50;">82%</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Tech Feature Citations</span>
                        <span class="metric-value">189</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Avg. Position</span>
                        <span class="metric-value">#1</span>
                    </div>
                </div>
            </div>
            <div class="platform-card">
                <div class="platform-header">
                    <div class="platform-icon perplexity">P</div>
                    <div>
                        <h3>Perplexity</h3>
                        <p style="font-size: 12px; color: #8892b0;">Last updated: 3 min ago</p>
                    </div>
                </div>
                <div class="platform-metrics">
                    <div class="metric-row">
                        <span class="metric-label">Visibility Score</span>
                        <span class="metric-value" style="color: #ff9800;">65%</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Tech Feature Citations</span>
                        <span class="metric-value">98</span>
                    </div>
                    <div class="metric-row">
                        <span class="metric-label">Avg. Position</span>
                        <span class="metric-value">#3</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Additional Charts -->
        <section class="chart-section">
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Technology Feature Mentions</h3>
                </div>
                <div id="tech-features-chart" class="chart-container"></div>
            </div>
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Competitor Analysis</h3>
                </div>
                <div id="competitor-chart" class="chart-container"></div>
            </div>
        </section>

        <!-- Content Analysis Table -->
        <div class="content-table">
            <div class="content-table-header">
                <h3 class="chart-title">Content Performance Analysis</h3>
                <div class="table-filters">
                    <select class="filter-select">
                        <option>All Content Types</option>
                        <option>FAQ</option>
                        <option>Product Manual</option>
                        <option>Reviews</option>
                    </select>
                    <select class="filter-select">
                        <option>All Products</option>
                        <option>FC9 Series</option>
                        <option>Beetle Robot</option>
                        <option>Ubox</option>
                    </select>
                </div>
            </div>
            <table>
                <thead>
                    <tr>
                        <th>Content ID</th>
                        <th>Type</th>
                        <th>Product Line</th>
                        <th>Citations</th>
                        <th>BMR Impact</th>
                        <th>Status</th>
                        <th>Last Updated</th>
                    </tr>
                </thead>
                <tbody id="content-table-body">
                    <tr>
                        <td>FAQ-001</td>
                        <td>FAQ</td>
                        <td>FC9 Pro</td>
                        <td>324</td>
                        <td style="color: #4caf50;">+2.4%</td>
                        <td><span class="status-badge active">Active</span></td>
                        <td>2 hours ago</td>
                    </tr>
                    <tr>
                        <td>MAN-042</td>
                        <td>Manual</td>
                        <td>Beetle Robot</td>
                        <td>189</td>
                        <td style="color: #4caf50;">+1.8%</td>
                        <td><span class="status-badge active">Active</span></td>
                        <td>1 day ago</td>
                    </tr>
                    <tr>
                        <td>REV-015</td>
                        <td>Review</td>
                        <td>FC9 Series</td>
                        <td>456</td>
                        <td style="color: #4caf50;">+3.2%</td>
                        <td><span class="status-badge active">Active</span></td>
                        <td>3 hours ago</td>
                    </tr>
                    <tr>
                        <td>FAQ-028</td>
                        <td>FAQ</td>
                        <td>Ubox</td>
                        <td>87</td>
                        <td style="color: #ff9800;">+0.5%</td>
                        <td><span class="status-badge pending">Pending</span></td>
                        <td>5 days ago</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- RAG Performance Metrics -->
        <section class="chart-section">
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">RAG Pipeline Performance</h3>
                </div>
                <div id="rag-performance-chart" class="chart-container"></div>
            </div>
            <div class="chart-card">
                <div class="chart-header">
                    <h3 class="chart-title">Query Categories Distribution</h3>
                </div>
                <div id="query-categories-chart" class="chart-container"></div>
            </div>
        </section>
    </main>

    <script>
        // Initialize ECharts instances
        let bmrChart, platformChart, techFeaturesChart, competitorChart, ragPerformanceChart, queryCategoriesChart;

        // Initialize all charts
        function initCharts() {
            // BMR Trend Chart
            bmrChart = echarts.init(document.getElementById('bmr-chart'));
            const bmrOption = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    textStyle: { color: '#fff' }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    data: generateDateLabels(7),
                    axisLine: { lineStyle: { color: '#3a4f6f' } },
                    axisLabel: { color: '#8892b0' }
                },
                yAxis: {
                    type: 'value',
                    axisLine: { lineStyle: { color: '#3a4f6f' } },
                    axisLabel: { color: '#8892b0', formatter: '{value}%' },
                    splitLine: { lineStyle: { color: '#2a3f5f' } }
                },
                series: [{
                    name: 'BMR',
                    type: 'line',
                    smooth: true,
                    symbol: 'circle',
                    symbolSize: 8,
                    sampling: 'average',
                    itemStyle: {
                        color: '#00e5ff'
                    },
                    areaStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                            { offset: 0, color: 'rgba(0, 229, 255, 0.3)' },
                            { offset: 1, color: 'rgba(0, 229, 255, 0.05)' }
                        ])
                    },
                    data: [65.2, 66.8, 68.3, 67.9, 69.5, 71.2, 72.5]
                }]
            };
            bmrChart.setOption(bmrOption);

            // Platform Distribution Chart
            platformChart = echarts.init(document.getElementById('platform-chart'));
            const platformOption = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: { type: 'shadow' },
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    textStyle: { color: '#fff' }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: ['Google AI', 'ChatGPT', 'Perplexity', 'Voice Assistants', 'Official Site'],
                    axisLine: { lineStyle: { color: '#3a4f6f' } },
                    axisLabel: { color: '#8892b0', rotate: 15 }
                },
                yAxis: {
                    type: 'value',
                    axisLine: { lineStyle: { color: '#3a4f6f' } },
                    axisLabel: { color: '#8892b0' },
                    splitLine: { lineStyle: { color: '#2a3f5f' } }
                },
                series: [{
                    name: 'Queries',
                    type: 'bar',
                    data: [3420, 2890, 1560, 980, 2150],
                    itemStyle: {
                        color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                            { offset: 0, color: '#00e5ff' },
                            { offset: 1, color: '#00acc1' }
                        ])
                    }
                }]
            };
            platformChart.setOption(platformOption);

            // Technology Features Chart
            techFeaturesChart = echarts.init(document.getElementById('tech-features-chart'));
            const techFeaturesOption = {
                tooltip: {
                    trigger: 'item',
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    textStyle: { color: '#fff' }
                },
                radar: {
                    indicator: [
                        { name: 'Electrolyzed Water', max: 100 },
                        { name: '99.9% Sanitization', max: 100 },
                        { name: 'Silver Ion Tech', max: 100 },
                        { name: '50°C Self-drying', max: 100 },
                        { name: '82 Patents', max: 100 },
                        { name: 'Chemical-free', max: 100 }
                    ],
                    splitArea: {
                        areaStyle: {
                            color: ['rgba(0, 229, 255, 0.05)', 'rgba(0, 229, 255, 0.1)']
                        }
                    },
                    axisLine: { lineStyle: { color: '#3a4f6f' } },
                    splitLine: { lineStyle: { color: '#3a4f6f' } },
                    axisName: { color: '#8892b0' }
                },
                series: [{
                    name: 'Feature Mentions',
                    type: 'radar',
                    data: [{
                        value: [92, 88, 75, 82, 68, 95],
                        name: 'Current Week',
                        lineStyle: { color: '#00e5ff' },
                        areaStyle: { color: 'rgba(0, 229, 255, 0.2)' }
                    }, {
                        value: [85, 82, 70, 78, 65, 90],
                        name: 'Last Week',
                        lineStyle: { color: '#ff6b6b' },
                        areaStyle: { color: 'rgba(255, 107, 107, 0.1)' }
                    }]
                }]
            };
            techFeaturesChart.setOption(techFeaturesOption);

            // Competitor Analysis Chart
            competitorChart = echarts.init(document.getElementById('competitor-chart'));
            const competitorOption = {
                tooltip: {
                    trigger: 'axis',
                    axisPointer: { type: 'shadow' },
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    textStyle: { color: '#fff' }
                },
                legend: {
                    data: ['Eureka', 'Competitor A', 'Competitor B'],
                    textStyle: { color: '#8892b0' }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'value',
                    axisLine: { lineStyle: { color: '#3a4f6f' } },
                    axisLabel: { color: '#8892b0', formatter: '{value}%' },
                    splitLine: { lineStyle: { color: '#2a3f5f' } }
                },
                yAxis: {
                    type: 'category',
                    data: ['Brand Mentions', 'Tech Features', 'User Reviews', 'Purchase Intent'],
                    axisLine: { lineStyle: { color: '#3a4f6f' } },
                    axisLabel: { color: '#8892b0' }
                },
                series: [
                    {
                        name: 'Eureka',
                        type: 'bar',
                        data: [72.5, 85.3, 78.9, 68.4],
                        itemStyle: { color: '#00e5ff' }
                    },
                    {
                        name: 'Competitor A',
                        type: 'bar',
                        data: [58.2, 42.1, 65.3, 55.8],
                        itemStyle: { color: '#ff6b6b' }
                    },
                    {
                        name: 'Competitor B',
                        type: 'bar',
                        data: [45.6, 38.9, 52.4, 48.2],
                        itemStyle: { color: '#ffd93d' }
                    }
                ]
            };
            competitorChart.setOption(competitorOption);

            // RAG Performance Chart
            ragPerformanceChart = echarts.init(document.getElementById('rag-performance-chart'));
            const ragPerformanceOption = {
                tooltip: {
                    trigger: 'axis',
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    textStyle: { color: '#fff' }
                },
                legend: {
                    data: ['Retrieval', 'Rerank', 'Generation', 'Total'],
                    textStyle: { color: '#8892b0' }
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                xAxis: {
                    type: 'category',
                    data: generateTimeLabels(24),
                    axisLine: { lineStyle: { color: '#3a4f6f' } },
                    axisLabel: { color: '#8892b0', interval: 3 }
                },
                yAxis: {
                    type: 'value',
                    axisLine: { lineStyle: { color: '#3a4f6f' } },
                    axisLabel: { color: '#8892b0', formatter: '{value}ms' },
                    splitLine: { lineStyle: { color: '#2a3f5f' } }
                },
                series: [
                    {
                        name: 'Retrieval',
                        type: 'line',
                        smooth: true,
                        data: generateRandomData(24, 40, 60),
                        itemStyle: { color: '#4caf50' }
                    },
                    {
                        name: 'Rerank',
                        type: 'line',
                        smooth: true,
                        data: generateRandomData(24, 30, 50),
                        itemStyle: { color: '#ff9800' }
                    },
                    {
                        name: 'Generation',
                        type: 'line',
                        smooth: true,
                        data: generateRandomData(24, 150, 200),
                        itemStyle: { color: '#e91e63' }
                    },
                    {
                        name: 'Total',
                        type: 'line',
                        smooth: true,
                        data: generateRandomData(24, 250, 310),
                        itemStyle: { color: '#00e5ff' },
                        lineStyle: { width: 3 }
                    }
                ]
            };
            ragPerformanceChart.setOption(ragPerformanceOption);

            // Query Categories Chart
            queryCategoriesChart = echarts.init(document.getElementById('query-categories-chart'));
            const queryCategoriesOption = {
                tooltip: {
                    trigger: 'item',
                    backgroundColor: 'rgba(0, 0, 0, 0.8)',
                    textStyle: { color: '#fff' }
                },
                series: [{
                    name: 'Query Categories',
                    type: 'pie',
                    radius: ['40%', '70%'],
                    avoidLabelOverlap: false,
                    itemStyle: {
                        borderRadius: 10,
                        borderColor: '#1a2332',
                        borderWidth: 2
                    },
                    label: {
                        show: true,
                        color: '#8892b0'
                    },
                    emphasis: {
                        label: {
                            show: true,
                            fontSize: '16',
                            fontWeight: 'bold',
                            color: '#fff'
                        }
                    },
                    data: [
                        { value: 35, name: 'Product Features', itemStyle: { color: '#00e5ff' } },
                        { value: 28, name: 'Comparisons', itemStyle: { color: '#4caf50' } },
                        { value: 22, name: 'How-to Guides', itemStyle: { color: '#ff9800' } },
                        { value: 15, name: 'Troubleshooting', itemStyle: { color: '#e91e63' } }
                    ]
                }]
            };
            queryCategoriesChart.setOption(queryCategoriesOption);
        }

        // Helper functions
        function generateDateLabels(days) {
            const labels = [];
            const today = new Date();
            for (let i = days - 1; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                labels.push(date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }));
            }
            return labels;
        }

        function generateTimeLabels(hours) {
            const labels = [];
            for (let i = 0; i < hours; i++) {
                labels.push(`${i}:00`);
            }
            return labels;
        }

        function generateRandomData(count, min, max) {
            const data = [];
            for (let i = 0; i < count; i++) {
                data.push(Math.floor(Math.random() * (max - min + 1)) + min);
            }
            return data;
        }

        // Update BMR chart based on time range
        function updateBMRChart(range) {
            const buttons = document.querySelectorAll('.chart-control-btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            let data, labels;
            switch(range) {
                case '7d':
                    labels = generateDateLabels(7);
                    data = [65.2, 66.8, 68.3, 67.9, 69.5, 71.2, 72.5];
                    break;
                case '30d':
                    labels = generateDateLabels(30);
                    data = generateRandomData(30, 60, 75);
                    break;
                case '90d':
                    labels = generateDateLabels(90);
                    data = generateRandomData(90, 55, 75);
                    break;
            }

            bmrChart.setOption({
                xAxis: { data: labels },
                series: [{ data: data }]
            });
        }

        // Test Query Function
        async function testQuery() {
            const query = document.getElementById('test-query').value;
            const platform = document.getElementById('platform-select').value;
            const output = document.getElementById('test-output');
            const status = document.getElementById('test-status');

            if (!query) {
                output.textContent = 'Please enter a query to test.';
                return;
            }

            // Show loading state
            status.innerHTML = '<span class="loading"></span> Testing...';
            status.style.color = '#ff9800';
            output.innerHTML = '<span class="loading"></span> Analyzing query across platforms...';

            try {
                // Make real API call
                const response = await fetch('http://localhost:3000/api/test-query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ query, platform })
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const results = await response.json();

                // Format output
                output.innerHTML = `
<strong>Query Analysis Results</strong>
═══════════════════════════════════════════════════════════════

Query: "${results.query}"
Platform: ${results.platform === 'all' ? 'All Platforms' : results.platform}
Timestamp: ${new Date(results.timestamp).toLocaleString()}

<strong>Performance Metrics:</strong>
├─ Brand Mentioned: ${results.results.brand_mentioned ? '✓ Yes' : '✗ No'}
├─ Confidence Score: ${(results.results.confidence * 100).toFixed(1)}%
├─ Response Time: ${results.results.latency}ms
└─ Tech Features Cited: ${results.results.tech_features_cited.join(', ')}

<strong>Response Preview:</strong>
"${results.results.response_preview}"

<strong>Source Documents Used:</strong>
${results.results.sources.map((src, i) => 
    `${i + 1}. ${src.type} (${src.id}) - Relevance: ${(src.relevance * 100).toFixed(0)}%`
).join('\n')}

<strong>Guardrail Checks:</strong>
├─ Brand Protection: ✓ Passed
├─ Technical Accuracy: ✓ Verified
├─ Compliance: ✓ Clean
└─ Competitor Mentions: None detected
`;

                status.textContent = 'Test Complete';
                status.style.color = '#4caf50';

                // Update live metrics
                updateLiveMetrics();
            } catch (error) {
                console.error('API Error:', error);
                status.textContent = 'Error';
                status.style.color = '#f44336';
                output.innerHTML = `<span style="color: #f44336;">Error: ${error.message}</span>`;
            }
        }

        // Update live metrics
        function updateLiveMetrics() {
            // Simulate metric updates
            const bmrValue = document.getElementById('bmr-value');
            const currentBMR = parseFloat(bmrValue.textContent);
            const newBMR = currentBMR + (Math.random() * 0.2 - 0.1);
            bmrValue.textContent = newBMR.toFixed(1) + '%';

            // Update charts with new data point
            const bmrData = bmrChart.getOption().series[0].data;
            bmrData.push(newBMR);
            bmrData.shift();
            bmrChart.setOption({
                series: [{ data: bmrData }]
            });
        }

        // Real-time updates simulation
        setInterval(() => {
            // Update platform query counts
            const platformData = platformChart.getOption().series[0].data;
            platformData.forEach((val, idx) => {
                platformData[idx] = val + Math.floor(Math.random() * 10 - 3);
            });
            platformChart.setOption({
                series: [{ data: platformData }]
            });

            // Update performance metrics
            const latencyValue = document.getElementById('latency-value');
            const currentLatency = parseInt(latencyValue.textContent);
            const newLatency = Math.max(200, Math.min(350, currentLatency + Math.floor(Math.random() * 20 - 10)));
            latencyValue.textContent = newLatency + 'ms';
        }, 5000);

        // Window resize handler
        window.addEventListener('resize', () => {
            bmrChart.resize();
            platformChart.resize();
            techFeaturesChart.resize();
            competitorChart.resize();
            ragPerformanceChart.resize();
            queryCategoriesChart.resize();
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            initCharts();
        });

        // Add keyboard shortcut for query testing
        document.getElementById('test-query').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                testQuery();
            }
        });
    </script>
</body>
</html>